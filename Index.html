<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>TEEG</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<style>
body { background:#0b3d2e; color:white; font-family:Arial; padding:20px; text-align:center }
button { padding:10px; margin:5px; font-size:16px }
.disabled { opacity:0.4 }

#bomb, #teeg {
  position:fixed; inset:0; display:none;
  align-items:center; justify-content:center;
  font-size:60px; z-index:999;
}
#bomb { background:red }
#teeg { background:black; color:red; flex-direction:column }
</style>
</head>

<body>

<div id="bomb">ðŸ’¥ BOMB ðŸ’¥</div>
<div id="teeg">
  <div id="teegText"></div>
  <button onclick="alert(`YOU'RE SHIT ðŸ˜ˆ`)">YOU'RE SHIT</button>
</div>

<h1>TEEG</h1>

<input id="name" placeholder="Your name"><br><br>
<button onclick="createRoom()">Create Room</button><br><br>

<input id="roomInput" placeholder="Room code">
<button onclick="joinRoom()">Join Room</button>

<h2 id="room"></h2>
<h3 id="turn"></h3>

<h3>Players</h3><div id="players"></div>
<h3>Your Hand</h3><div id="hand"></div>
<h3>Play Pile</h3><div id="pile"></div>

<script>
const socket = io("https://teeg-server.onrender.com", {
  transports: ["polling"],
  forceNew: true
});

socket.on("connect", () => alert("CONNECTED TO SERVER"));
socket.on("connect_error", e => alert("CONNECT ERROR: " + e.message));

let myName = "", roomId = "";

function createRoom() {
  myName = name.value;
  socket.emit("create-room", myName, id => {
    roomId = id;
    room.innerText = "Room: " + id;
  });
}

function joinRoom() {
  myName = name.value;
  roomId = roomInput.value;
  room.innerText = "Room: " + roomId;
  socket.emit("join-room", { roomId, name: myName });
}

socket.on("state", s => {
  players.innerHTML = hand.innerHTML = pile.innerHTML = "";
  const cp = s.players[s.turn];
  turn.innerText = cp.name === myName ? "ðŸ‘‰ YOUR TURN" : "Waiting for " + cp.name;

  s.players.forEach(p => {
    players.innerHTML += `<div>${p.name}</div>`;
    if (p.name === myName)
      p.hand.forEach(c => {
        const b = document.createElement("button");
        b.innerText = c;
        if (cp.name !== myName) b.disabled = true;
        b.onclick = () => socket.emit("play", { roomId, card:c });
        hand.appendChild(b);
      });
  });

  s.pile.forEach(c => pile.innerText += c + " ");
});

socket.on("bomb", () => {
  bomb.style.display = "flex";
  setTimeout(()=>bomb.style.display="none",800);
});

socket.on("game-over", d => {
  teeg.style.display="flex";
  teegText.innerText = d.teeg + " IS THE TEEG";
});
</script>
</body>
</html>
